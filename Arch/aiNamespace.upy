
def name():
  return "AI Namespace"

def description():
  return '''Group entities by their parent namespace.

  <p>For each entity in the database that is of a kind used by default for AI 
  overviews (classes, packages, files, functions, procedures, methods, routines, 
  and global objects), this architecture checks if the entity's parent is a 
  namespace. If it is, the entity is mapped to the longname of that namespace. 
  Entities without a namespace parent are not mapped to any architecture component.</p>
  
  <p>This is useful for organizing code by namespace structure, which can help 
  with understanding the organization and relationships within a codebase.</p>
'''

def tags():
  return [
    'Language: Basic',
    'Language: C',
    'Language: C++',
    'Language: C#',
    'Language: Pascal',
    'Language: JavaScript',
    'Language: PHP',
  ]

AI_KINDS = ("class ~unknown ~unnamed,"
  "package ~unknown ~unnamed"
  "file ~unknown ~unnamed ~unresolved,"
  "function ~unknown ~unnamed,"
  "procedure ~unknown ~unnamed,"
  "method ~unknown ~unnamed,"
  "routine ~unknown ~unnamed"
  "object global ~unknown ~unnamed")

def build(arch, db):
  for ent in db.ents(AI_KINDS):
    parent = ent.parent()
    if parent and parent.kind().check("namespace"):
      namespace_name = parent.longname().replace("::", "/")
      arch.map(ent, namespace_name)

