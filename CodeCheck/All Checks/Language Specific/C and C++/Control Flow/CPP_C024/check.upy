# This script is designed to run with Understand - CodeCheck
# Rewritten by Robby Bennett
# 2025-09-30


import re


ERR1 = 'File contains "continue" statement'


def ids():
    return ('MISRA04_14.5', 'CPP_C024')


def name(id):
    return {
        'MISRA04_14.5': '''Published Standards/MISRA-C 2004/\
14.5 No Continue Statements''',
        'CPP_C024': '''All Checks/Language Specific/C and C++/Control Flow/\
No Continue Statements''',
    }[id]


def tags(id):
    return {
        'MISRA04_14.5': [
            'Control Flow',
            'Language: C',
            'Language: C++',
            'Standard: MISRA C 2004',
            'Category: Required',
        ],
        'CPP_C024': [
            'Control Flow',
            'Language: C',
            'Language: C++',
        ],
    }.get(id)


def detailed_description(id):
    return '''\
<p><b>Title</b></p>

The continue statement shall not be used.
'''


def test_entity(file):
    return True


def test_global():
    return False


def test_language(language):
    return language == 'C++'


def check(check, file):
    lex = file.lexer().first()
    while lex:
        if lex.text() == 'continue' and lex.token() == 'Keyword':
            check.violation(lex.ent(), file, lex.line_begin(), lex.column_begin(), ERR1)
        lex = lex.next(True, True)
